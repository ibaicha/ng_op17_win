import { Injectable } from '@angular/core';

import { Actions, createEffect, ofType } from '@ngrx/effects';

import { map, switchMap } from 'rxjs/operators';

import * as fromExploitationCustoms from './index';
import { ExploitationService } from '../../../services/exploitation.service';
import { IExploitationCustom } from '../../../interfaces/exploitation.interface';

@Injectable()
export class ExploitationCustomEffects {
    constructor(private readonly actions$: Actions, private readonly exploitationService: ExploitationService) {
    }

    getExploitationCustoms$ = createEffect(() =>
        this.actions$.pipe(
            ofType(fromExploitationCustoms.getExploitationCustoms.type),
            switchMap(() => this.exploitationService.getAllCustom()),
            map((exploitationCustoms: IExploitationCustom[]) => fromExploitationCustoms.getExploitationCustomsSuccess({exploitationCustoms}))
        )
    );


}
